<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ztman.ztspark.mapper.WorkOrderSuperviseMapper">

	<!-- 通用返回对象 -->
	<resultMap type="com.ztman.ztspark.entity.workorder.WorkOrderSupervise"
		id="workOrderSuperviseResult">
		<result property="id" column="id" /> <!-- 核查编号 -->
		<result property="workOrderId" column="work_order_id" /> <!-- 工单号 -->
		<result property="description" column="description" /> <!-- 完成情况说明 -->
		<result property="pmin" column="pmin" /> <!-- 督办时限 -->
		<result property="smsReminder" column="sms_reminder" /> <!-- 短信提醒 -->
		<result property="smsReminderPhone" column="sms_reminder_phone" /> <!-- 短信提醒手机号 -->
		<result property="superviseUserId" column="supervise_user_id" /> <!-- 督办用户 -->
		<result property="createTime" column="create_time" /> <!-- 创建时间 -->
		<result property="reasons" column="reasons" /> <!-- 创建时间 -->

	</resultMap>


	<sql id="selectWorkOrderSuperviseVo">
		select id, work_order_id, description, pmin, sms_reminder,
		sms_reminder_phone, supervise_user_id, create_time,reasons from
		work_order_supervise
	</sql>
	<!-- 查询对象List -->
	<select id="selectWorkOrderSuperviseList" parameterType="WorkOrderSupervise"
		resultMap="workOrderSuperviseResult">
		<include refid="selectWorkOrderSuperviseVo" />
		<where>
			<include refid="equal" />
		</where>
	</select>

	<!-- 模糊查询对象List -->
	<select id="selectWorkOrderSuperviseListByLike" parameterType="WorkOrderSupervise"
		resultMap="workOrderSuperviseResult">
		<include refid="selectWorkOrderSuperviseVo" />
		<where>
			<include refid="like" />
		</where>
	</select>

	<!-- 根据主键查询对象 -->
	<select id="selectWorkOrderSuperviseById" parameterType="Long"
		resultMap="workOrderSuperviseResult">
		<include refid="selectWorkOrderSuperviseVo" />
		where id = #{id}
	</select>

	<!-- 根据订单id查询被派遣人手机号 -->
	<select id="getSmsReminderPhoneByWorkOrderId" parameterType="String"
		resultType="String">
		SELECT
		a.phone
		FROM
		sys_user AS a
		INNER JOIN work_order AS b ON a.user_id = b.assign_user_id
		WHERE
		b.id = #{workOrderId}
	</select>

	<update id="updateWorkOrderSupervise" parameterType="WorkOrderSupervise">
		update work_order_supervise
		<trim prefix="SET" suffixOverrides=",">
			<if test="workOrderId != null  and workOrderId != ''  ">work_order_id = #{workOrderId},</if>
			<if test="description != null  and description != ''  ">description = #{description},</if>
			<if test="pmin != null  and pmin != ''  ">pmin = #{pmin},</if>
			<if test="smsReminder != null  and smsReminder != ''  ">sms_reminder = #{smsReminder},</if>
			<if test="smsReminderPhone != null  and smsReminderPhone != ''  ">sms_reminder_phone = #{smsReminderPhone},</if>
			<if test="superviseUserId != null  and superviseUserId != ''  ">supervise_user_id = #{superviseUserId},</if>
			<if test="createTime != null  ">create_time = #{createTime},</if>
			<if test="reasons != null and reasons != ''">reasons = #{reasons},</if>
		</trim>
		where id = #{id}
	</update>

	<delete id="deleteWorkOrderSuperviseById" parameterType="Long">
		delete from work_order_supervise where id = #{id}
	</delete>

	<delete id="deleteWorkOrderSuperviseByIds" parameterType="String">
		delete from work_order_supervise where id in
		<foreach item="id" collection="array" open="(" separator=","
			close=")">
			#{id}
		</foreach>
	</delete>



	<!-- 新增对象 -->
	<insert id="insertWorkOrderSupervise" parameterType="WorkOrderSupervise"
		useGeneratedKeys="true" keyProperty="id">
		insert into work_order_supervise
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="workOrderId != null  and workOrderId != ''  ">work_order_id,</if>
			<if test="description != null  and description != ''  ">description,</if>
			<if test="pmin != null  and pmin != ''  ">pmin,</if>
			<if test="smsReminder != null  and smsReminder != ''  ">sms_reminder,</if>
			<if test="smsReminderPhone != null  and smsReminderPhone != ''  ">sms_reminder_phone,</if>
			<if test="superviseUserId != null  and superviseUserId != ''  ">supervise_user_id,</if>
			<if test="createTime != null  ">create_time,</if>
			<if test="reasons != null and reasons != '' ">reasons,</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="workOrderId != null  and workOrderId != ''  ">#{workOrderId},</if>
			<if test="description != null  and description != ''  ">#{description},</if>
			<if test="pmin != null  and pmin != ''  ">#{pmin},</if>
			<if test="smsReminder != null  and smsReminder != ''  ">#{smsReminder},</if>
			<if test="smsReminderPhone != null  and smsReminderPhone != ''  ">#{smsReminderPhone},</if>
			<if test="superviseUserId != null  and superviseUserId != ''  ">#{superviseUserId},</if>
			<if test="createTime != null  ">#{createTime},</if>
			<if test="reasons != null and reasons != '' ">#{reasons},</if>
		</trim>
	</insert>



	<!-- 表字段 -->
	<sql id="column">
		id,  <!-- 核查编号 -->
		work_order_id,  <!-- 工单号 -->
		description,  <!-- 完成情况说明 -->
		pmin,  <!-- 督办时限 -->
		sms_reminder,  <!-- 短信提醒 -->
		sms_reminder_phone,  <!-- 短信提醒手机号 -->
		supervise_user_id,  <!-- 督办用户 -->
		create_time,  <!-- 创建时间 -->
		reasons
	</sql>

	<!-- Where精确匹配字段 -->
	<sql id="equal">
		<if test="id != null ">
			AND id = #{id}  <!-- 核查编号 -->
		</if>
		<if test="workOrderId != null and workOrderId != ''">
			AND work_order_id = #{workOrderId}  <!-- 工单号 -->
		</if>
		<if test="description != null and description != ''">
			AND description = #{description}  <!-- 完成情况说明 -->
		</if>
		<if test="pmin != null and pmin != ''">
			AND pmin = #{pmin}  <!-- 督办时限 -->
		</if>
		<if test="smsReminder != null and smsReminder != ''">
			AND sms_reminder = #{smsReminder}  <!-- 短信提醒 -->
		</if>
		<if test="smsReminderPhone != null and smsReminderPhone != ''">
			AND sms_reminder_phone = #{smsReminderPhone}  <!-- 短信提醒手机号 -->
		</if>
		<if test="superviseUserId != null and superviseUserId != ''">
			AND supervise_user_id = #{superviseUserId}  <!-- 督办用户 -->
		</if>
		<if test="createTime != null ">
			AND create_time = #{createTime}  <!-- 创建时间 -->
		</if>
		<if test="reasons != null and reasons != '' ">
			AND reasons = #{reasons}  <!-- 创建时间 -->
		</if>
	</sql>

	<!-- Where模糊匹配字段 -->
	<sql id="like">
		<if test="workOrderId != null and workOrderId != ''">
			AND work_order_id like '%${workOrderId}%'  <!-- 工单号 -->
		</if>
		<if test="description != null and description != ''">
			AND description like '%${description}%'  <!-- 完成情况说明 -->
		</if>
		<if test="pmin != null and pmin != ''">
			AND pmin like '%${pmin}%'  <!-- 督办时限 -->
		</if>
		<if test="smsReminder != null and smsReminder != ''">
			AND sms_reminder like '%${smsReminder}%'  <!-- 短信提醒 -->
		</if>
		<if test="smsReminderPhone != null and smsReminderPhone != ''">
			AND sms_reminder_phone like '%${smsReminderPhone}%'  <!-- 短信提醒手机号 -->
		</if>
		<if test="superviseUserId != null and superviseUserId != ''">
			AND supervise_user_id like '%${superviseUserId}%'  <!-- 督办用户 -->
		</if>
		<if test="reasons != null and reasons != ''">
			AND reasons like '%${reasons}%'  <!-- 督办用户 -->
		</if>
	</sql>
</mapper>
